# ncbi_genome_download

[üîô Back to Main Repo](../../../README.md) | [üîó Original Repo](https://github.com/kblin/ncbi-genome-download)

![Tool Count](https://img.shields.io/badge/Agent_Tools-21-blue?style=flat-square)
![Category](https://img.shields.io/badge/Category-Biology-green?style=flat-square)
![Status](https://img.shields.io/badge/Import_Test-Passed-success?style=flat-square)

## üìñ Overview

`ncbi_genome_download` is a command-line Python tool for efficiently downloading genome assemblies (e.g., bacterial, fungal, viral) from NCBI RefSeq/GenBank in formats like FASTA or GenBank, with support for filtering and parallel downloads.

> **Note**: This documentation lists the **agent-ready wrapper functions** generated for this package. These functions have been strictly typed, docstring-enhanced, and tested for import stability within a standardized Apptainer environment.

## üõ†Ô∏è Available Agent Tools

Below is the list of **21** functions optimized for LLM tool-use.

| **Tool Name (Wrapper)**   | **Source**          | **File Path**     | **Arguments (Type)**        | **Description**                |
| ------------------------- | ------------------- | ----------------- | --------------------------- | ------------------------------ |
| `ncbi_genome_download_core_argument_parser` | `ncbi_genome_download.core.argument_parser` | `ncbi_genome_download/core.py` | `version: str = None` | `ncbi_genome_download.core.argument_parser creates and returns a fully configured argparse.ArgumentParser for the ncbi-genome-download command-line interface. This parser defines the CLI arguments and help text used by the tool described in the README for downloading genome files from NCBI (for example: selecting taxonomic groups such as "bacteria" or "viral", choosing file formats like "fasta", filtering by taxids/genera/assembly levels, and controlling download behavior such as parallelism, caching, and progress display). The parser wiring uses NgdConfig.get_default(...) to populate default values and NgdConfig.get_choices(...) to populate choice lists for options where appropriate, and it declares deprecated aliases using DeprecatedAction. The returned parser is intended to be used by higher-level functions (for example, ncbi_genome_download.download()) to parse command-line arguments and drive the download workflow described in the README.` |
| `ncbi_genome_download_core_convert_ftp_url` | `ncbi_genome_download.core.convert_ftp_url` | `ncbi_genome_download/core.py` | `url: str` | `ncbi_genome_download.core.convert_ftp_url converts an FTP URL string into an HTTPS URL string by replacing the initial "ftp://" scheme with "https://".` |
| `ncbi_genome_download_core_create_dir` | `ncbi_genome_download.core.create_dir` | `ncbi_genome_download/core.py` | `entry: dict, section: str, domain: str, output: str, flat_output: bool` | `ncbi_genome_download.core.create_dir creates (if necessary) and returns the filesystem directory used to store files for a single genome assembly entry when downloading NCBI genomes with ncbi-genome-download. In the ncbi-genome-download workflow this function determines the output location for a download based on the requested section (for example 'refseq' vs 'genbank' indicated via the --section option in the tool), the domain or dataset grouping used by the tool (for example groupings like 'bacteria' or 'viral' shown in the README usage), and the assembly accession identifier found in the provided entry. The directory returned is intended to hold all files for that single assembly and mirrors the logical layout used by the downloader unless a flat output layout is requested.` |
| `ncbi_genome_download_core_create_readable_dir` | `ncbi_genome_download.core.create_readable_dir` | `ncbi_genome_download/core.py` | `entry: dict, section: str, domain: str, output: str` | `Create the a human-readable directory for a single assembly entry and return its full path. This function is used by the ncbi-genome-download tool when the user requests a human-readable layout (for example via the --human-readable option described in the README). It constructs a directory path that parallels a readable, taxonomically organized view of NCBI assemblies and ensures that the directory exists on disk. The created directory is intended to be the location where link files (or other human-oriented files) for the given assembly entry can be placed; creating the directory itself does not create links. For non-viral domains the path is built from genus, species and strain labels derived by calling get_genus_label(entry), get_species_label(entry) and get_strain_label(entry). For the viral domain the path uses the entry['organism_name'] (with spaces replaced by underscores) and get_strain_label(entry, viral=True) instead.` |
| `ncbi_genome_download_core_create_symlink` | `ncbi_genome_download.core.create_symlink` | `ncbi_genome_download/core.py` | `local_file: str, symlink_path: str` | `Create a relative symbolic link for a downloaded genome file when a symlink path is provided. This function is used by the ncbi-genome-download package to create human-readable directory layouts that mirror the NCBI FTP/assembly structure (the --human-readable option). Instead of copying genome files into those human-readable locations, this function creates a relative symbolic link that points from the requested symlink location back to the actual saved file in the output folder, saving disk space and enabling a directory structure that is easy for users to inspect. The function normalizes the provided paths, removes any existing file or link at the target symlink path, computes a relative path from the symlink location up to the output folder, and creates a symlink pointing to the normalized local file. If no symlink path is given, the function does nothing and returns success. Note that some platforms and filesystems (for example, some Windows configurations) may not support symbolic links or may require elevated privileges; ncbi-genome-download's README documents this limitation.` |
| `ncbi_genome_download_core_create_symlink_job` | `ncbi_genome_download.core.create_symlink_job` | `ncbi_genome_download/core.py` | `directory: str, checksums: dict, filetype: str, symlink_path: str` | `Create a DownloadJob configured to create a filesystem symlink for an already-downloaded genome file. This function is used by the ncbi-genome-download core to build a job that, when executed by the download/job runner, will create a symbolic link in a human-readable directory layout that points to an already-downloaded local file. It is intended for use with the "--human-readable" behavior described in the README where directory trees mirror NCBI layout and links are used to avoid duplicating downloaded files.` |
| `ncbi_genome_download_core_download_file_job` | `ncbi_genome_download.core.download_file_job` | `ncbi_genome_download/core.py` | `entry: dict, directory: str, checksums: dict, filetype: str = "genbank", symlink_path: str = None` | `Generate a DownloadJob configured to download a single file for an NCBI assembly entry. This function is used by the ncbi-genome-download pipeline to turn a parsed assembly metadata entry (from an NCBI assembly summary) and a pre-parsed checksum mapping into a DownloadJob object that worker code can execute to actually fetch a genome-related file (for example a GenBank, FASTA, or assembly-report file) from the NCBI FTP site. It does not perform any network I/O itself; it only constructs the download URL, determines the local target path, looks up the expected checksum for integrity verification, and optionally computes a human-readable symlink target path that mirrors NCBI's directory layout.` |
| `ncbi_genome_download_core_downloadjob_creator_caller` | `ncbi_genome_download.core.downloadjob_creator_caller` | `ncbi_genome_download/core.py` | `args: tuple` | `ncbi_genome_download.core.downloadjob_creator_caller: Thin wrapper used to invoke the internal create_downloadjob function by unpacking a tuple of positional arguments. This function exists to provide a single-argument callable suitable for use as the target function in multiprocessing worker pools (for example, multiprocessing.Pool.map or Pool.imap) when building parallel download jobs for NCBI genome assemblies. In the ncbi-genome-download toolchain this wrapper is used to convert an iterable of argument tuples into calls that construct download job descriptions for assemblies (the objects/records that represent work items used to download genome files such as FASTA or GenBank from NCBI FTP locations).` |
| `ncbi_genome_download_core_get_genus_label` | `ncbi_genome_download.core.get_genus_label` | `ncbi_genome_download/core.py` | `entry: dict` | `ncbi_genome_download.core.get_genus_label returns the genus (first token of the organism name) for an NCBI assembly summary entry. This function is used by the ncbi-genome-download tool to extract the genus string from an assembly entry's organism_name field so that entries can be grouped, filtered, or matched against user-specified genera (for example the --genera option described in the README).` |
| `ncbi_genome_download_core_get_name_and_checksum` | `ncbi_genome_download.core.get_name_and_checksum` | `ncbi_genome_download/core.py` | `checksums: list, end: str` | `Extract a full filename and its checksum from a checksums list for a file whose name ends with the given suffix. This function is used by the ncbi-genome-download tool to identify the exact archive or sequence file name and the associated checksum entry from a parsed checksums listing (the checksums metadata that accompanies NCBI assembly or FTP directory listings). The returned filename and checksum are intended for use when verifying a downloaded file against the authoritative checksum provided by NCBI. The function handles typical NCBI file-naming edge cases such as CDS and RNA FASTA files that themselves include the substring used by plain genomic FASTA names, avoiding false positive matches.` |
| `ncbi_genome_download_core_get_species_label` | `ncbi_genome_download.core.get_species_label` | `ncbi_genome_download/core.py` | `entry: dict` | `ncbi_genome_download.core.get_species_label: Extract the species label (the species epithet) from an NCBI assembly summary entry. This function is used in the ncbi-genome-download tool to derive a simple species identifier from the assembly summary "organism_name" field provided by NCBI. The typical "organism_name" value is a scientific name string such as "Escherichia coli str. K-12" or "Streptomyces coelicolor A3(2)". The function performs a simple whitespace split of that string and returns the second token (index 1), which represents the species epithet in common two-word scientific names. This lightweight parsing is useful for creating human-readable directory labels, grouping downloaded assemblies by species, or generating short species tags when building NCBI mirror-like directory structures as described in the project README.` |
| `ncbi_genome_download_core_get_strain` | `ncbi_genome_download.core.get_strain` | `ncbi_genome_download/core.py` | `entry: dict, viral: bool = False` | `ncbi_genome_download.core.get_strain: Extract a strain identifier string from a single NCBI assembly summary entry. This function is used by the ncbi-genome-download tool to derive a human-meaningful strain label from an assembly summary entry returned by NCBI. The derived strain label is typically used for naming output files or organizing downloaded genomes by strain. The function examines the entry in a prioritized order to find the most specific available strain information: it first inspects the 'infraspecific_name' field (handling values of the form "key=value" by taking the value after the final '='), then the 'isolate' field, and finally, when the entry's 'organism_name' consists of more than two whitespace-separated words and the viral flag is False, it treats all words from the third onward as the strain (joining them with single spaces). If none of these produce a non-empty string, the function falls back to returning the assembly accession from the 'assembly_accession' field. Empty strings in the checked fields are treated as absent. The viral parameter disables the organism_name-based extraction because viral organism names should not be parsed in this way for strain derivation. The function performs no I/O and has no side effects; it operates purely on the provided dictionary and returns a string.` |
| `ncbi_genome_download_core_get_strain_label` | `ncbi_genome_download.core.get_strain_label` | `ncbi_genome_download/core.py` | `entry: dict, viral: bool = False` | `Clean up and normalize a strain name extracted from an NCBI assembly metadata entry so it can be safely used in file names and directory names created by ncbi-genome-download.` |
| `ncbi_genome_download_core_get_summary` | `ncbi_genome_download.core.get_summary` | `ncbi_genome_download/core.py` | `section: str, domain: str, uri: str, use_cache: bool` | `Get the NCBI assembly_summary.txt for a given section and domain and return it as an in-memory text stream. This function is used by the ncbi-genome-download tool (see README) to obtain the assembly summary file that lists available assemblies for a given group (for example "bacteria", "viral") and domain (for example "refseq", "genbank"). The returned StringIO contains the full contents of the NCBI assembly_summary.txt file (tab-delimited metadata used by ncbi-genome-download to filter assemblies by taxid, assembly level, refseq category, etc.). The function implements a simple caching mechanism to avoid repeated downloads within a 1-day window and logs its actions to the "ncbi-genome-download" logger.` |
| `ncbi_genome_download_core_grab_checksums_file` | `ncbi_genome_download.core.grab_checksums_file` | `ncbi_genome_download/core.py` | `entry: dict` | `ncbi_genome_download.core.grab_checksums_file ‚Äî Retrieve the MD5 checksums file for a single NCBI assembly entry. Retrieves the remote "md5checksums.txt" file for a single assembly entry dictionary (as used throughout ncbi-genome-download). This function is intended to be used by the ncbi-genome-download download/process pipeline (see README) to obtain per-assembly MD5 checksum listings published by NCBI (RefSeq/GenBank) so callers can verify integrity of downloaded genome files.` |
| `ncbi_genome_download_core_has_file_changed` | `ncbi_genome_download.core.has_file_changed` | `ncbi_genome_download/core.py` | `directory: str, checksums: dict, filetype: str = "genbank"` | `ncbi_genome_download.core.has_file_changed determines whether a genome-related file in a local download directory is missing or has an MD5 checksum that differs from the expected checksum, indicating the file has changed and may need re-downloading or verification. This function is used by the ncbi-genome-download pipeline (see README) to validate downloaded genome files (by default GenBank files) against expected checksums derived from assembly summary metadata. It resolves the file extension for the requested filetype via NgdConfig.get_fileending(filetype), obtains the target filename and the expected checksum using get_name_and_checksum(checksums, pattern), then computes the actual MD5 checksum of the file on disk with md5sum and compares the two.` |
| `ncbi_genome_download_core_md5sum` | `ncbi_genome_download.core.md5sum` | `ncbi_genome_download/core.py` | `filename: str` | `ncbi_genome_download.core.md5sum calculates the MD5 checksum of a local file and returns its hexadecimal digest string. This function is used by the ncbi-genome-download toolset to verify file integrity for downloaded genome and assembly files (for example, to compare against NCBI-provided md5sums or to detect corrupted transfers), and is implemented to be memory-efficient and deterministic for reproducible integrity checks.` |
| `ncbi_genome_download_core_need_to_create_symlink` | `ncbi_genome_download.core.need_to_create_symlink` | `ncbi_genome_download/core.py` | `directory: str, checksums: dict, filetype: str, symlink_path: str` | `Check whether a human-readable symlink should be created for an already-downloaded NCBI genome file. This function is used by the ncbi-genome-download pipeline when the user requests a human-readable directory layout (for example via the --human-readable option described in the README). It determines, without modifying the filesystem, whether a symlink in the requested symlink_path directory should be created that points to the real file in directory. The decision is based on the file name derived from checksums for the requested filetype and on the current state of an existing symlink (if any).` |
| `ncbi_genome_download_core_parse_checksums` | `ncbi_genome_download.core.parse_checksums` | `ncbi_genome_download/core.py` | `checksums_string: str` | `ncbi_genome_download.core.parse_checksums parses the textual contents of a checksum file (as produced in NCBI FTP assembly directories) and returns a structured list of checksum-to-filename mappings suitable for use by the ncbi-genome-download verification and bookkeeping logic.` |
| `ncbi_genome_download_core_parse_summary` | `ncbi_genome_download.core.parse_summary` | `ncbi_genome_download/core.py` | `summary_file: str` | `Parse the NCBI assembly summary TSV file and return a reader that yields each summary row as a dictionary; this is used by ncbi-genome-download to inspect available assemblies and their metadata (for example ftp paths, taxonomy IDs, RefSeq/GenBank categories, assembly levels, and type-material relationships) when deciding which genome files to download.` |
| `ncbi_genome_download_metadata_get` | `ncbi_genome_download.metadata.get` | `ncbi_genome_download/metadata.py` | `columns: list = None` | `Get or create the ncbi_genome_download.metadata.MetaData singleton used by ncbi-genome-download to represent and manage genome assembly metadata. This function centralizes access to a single MetaData instance for the process. In the ncbi-genome-download domain this MetaData instance encapsulates which metadata columns are tracked for NCBI genome assembly records (for example, the columns parsed from assembly summary files used when selecting and downloading genomes). Calling get ensures that the same MetaData object is returned for all callers in the same process, avoiding repeated re-parsing or re-initialization of metadata state.` |

## ‚öñÔ∏è License

Original Code License: Apache-2.0

Wrapper Code & Documentation: Apache-2.0

*This file was automatically generated on February 26, 2026.*
