# useful_rdkit_utils

[üîô Back to Main Repo](../../../README.md) | [üîó Original Repo](https://github.com/PatWalters/useful_rdkit_utils)

![Tool Count](https://img.shields.io/badge/Agent_Tools-8-blue?style=flat-square)
![Category](https://img.shields.io/badge/Category-Chemistry-green?style=flat-square)
![Status](https://img.shields.io/badge/Import_Test-Passed-success?style=flat-square)

## üìñ Overview

useful_rdkit_utils is a collection of handy utility functions built on RDKit to simplify common cheminformatics tasks such as molecule handling, analysis, and workflow support.

> **Note**: This documentation lists the **agent-ready wrapper functions** generated for this package. These functions have been strictly typed, docstring-enhanced, and tested for import stability within a standardized Apptainer environment.

## üõ†Ô∏è Available Agent Tools

Below is the list of **8** functions optimized for LLM tool-use.

| **Tool Name (Wrapper)**   | **Source**          | **File Path**     | **Arguments (Type)**        | **Description**                |
| ------------------------- | ------------------- | ----------------- | --------------------------- | ------------------------------ |
| `useful_rdkit_utils_ring_systems_create_ring_dictionary` | `useful_rdkit_utils.ring_systems.create_ring_dictionary` | `useful_rdkit_utils/ring_systems.py` | `input_smiles: str, output_csv: str` | `useful_rdkit_utils.ring_systems.create_ring_dictionary: Read a whitespace-separated SMILES file, extract ring systems from each molecule using RDKit utilities, count frequency of each unique ring system (represented by an InChIKey), and write a CSV listing a representative SMILES, the InChI identifier, and the occurrence count for each ring system.` |
| `useful_rdkit_utils_ring_systems_get_min_ring_frequency` | `useful_rdkit_utils.ring_systems.get_min_ring_frequency` | `useful_rdkit_utils/ring_systems.py` | `ring_list: list` | `useful_rdkit_utils.ring_systems.get_min_ring_frequency returns the ring identifier and its minimum observed frequency from a ring-frequency list produced by RingSystemLookup.process_smiles, used in cheminformatics workflows that analyze ring systems with RDKit.` |
| `useful_rdkit_utils_seaborn_utils_set_sns_size` | `useful_rdkit_utils.seaborn_utils.set_sns_size` | `useful_rdkit_utils/seaborn_utils.py` | `width: float, height: float` | `useful_rdkit_utils.seaborn_utils.set_sns_size sets the default seaborn/matplotlib figure size used by subsequent plots in this useful_rdkit_utils package (for example in the demos and Jupyter notebooks included with the repository). The function calls seaborn.set(rc={'figure.figsize': (width, height)}) to update the global plotting rc parameters so that all following seaborn/matplotlib figures use the specified width and height in inches unless overridden.` |
| `useful_rdkit_utils_useful_rdkit_utils_rd_set_image_size` | `useful_rdkit_utils.useful_rdkit_utils.rd_set_image_size` | `useful_rdkit_utils/useful_rdkit_utils.py` | `x: int, y: int` | `Set the image size used by RDKit's IPythonConsole for molecule structure rendering. This function configures the global rendering size used by RDKit's IPythonConsole (used in Jupyter notebooks and interactive IPython sessions) by assigning a two-element tuple (x, y) to IPythonConsole.molSize. In the context of this repository (a collection of useful RDKit utilities and demo notebooks), rd_set_image_size is used to control how large 2D/3D molecular depictions appear when RDKit renders molecules inline. The change is global for the running Python process and affects all subsequent RDKit IPythonConsole renderings until overridden.` |
| `useful_rdkit_utils_useful_rdkit_utils_smi2mol_with_errors` | `useful_rdkit_utils.useful_rdkit_utils.smi2mol_with_errors` | `useful_rdkit_utils/useful_rdkit_utils.py` | `smi: str` | `Parse a SMILES string using RDKit and return the parsed RDKit molecule together with any warnings or error text that RDKit wrote to standard error during parsing. This function is intended for cheminformatics workflows (see project README: a collection of useful RDKit functions) where callers need both the parsed molecule for downstream operations (fingerprinting, substructure search, property calculation) and the textual diagnostic messages RDKit emits when a SMILES is ambiguous, has valence/atom errors, or triggers warnings. The function temporarily redirects Python's sys.stderr to capture RDKit stderr output produced by Chem.MolFromSmiles, then restores sys.stderr before returning. If parsing succeeds, the returned molecule can be used in typical RDKit pipelines; if parsing fails the molecule value will be None and the returned error string may contain explanatory messages. Behavior notes, side effects, and failure modes: - The function redirects the global sys.stderr to an in-memory buffer (io.StringIO) to capture messages written to stderr by RDKit during Chem.MolFromSmiles(smi). After capturing, it restores sys.stderr to the original sys.__stderr__. - The captured text includes warnings and diagnostic messages that RDKit would normally print to the process standard error (for example, valence warnings, kekulization issues, or other parser diagnostics). - If there are no messages written to stderr during parsing, the returned error string will be an empty string. - The first return value is the RDKit molecule object produced by Chem.MolFromSmiles or None if parsing failed; callers should check for None before using RDKit molecule APIs. - Because the function manipulates the global sys.stderr, it is not thread-safe: concurrent threads that rely on sys.stderr may observe the temporary redirection. Also, if Chem.MolFromSmiles or other code raises an exception while sys.stderr is redirected, the function does not use a try/finally to guarantee restoration; in that exceptional case sys.stderr may remain redirected and global state could be left altered. - The function does not attempt to capture messages sent via Python logging or other streams; it only captures text written to sys.stderr. - The function does not perform input validation beyond passing the provided smi string to RDKit; if RDKit is not available or Chem.MolFromSmiles is not present, a NameError/ImportError may be raised by the runtime.` |
| `useful_rdkit_utils_useful_rdkit_utils_smi2morgan_fp` | `useful_rdkit_utils.useful_rdkit_utils.smi2morgan_fp` | `useful_rdkit_utils/useful_rdkit_utils.py` | `smi: str, radius: int = 2, nBits: int = 2048` | `Convert a SMILES string to an RDKit Morgan (circular) fingerprint bit vector. This function is used in cheminformatics workflows (similarity searching, clustering, and machine learning) to convert a molecule represented as a SMILES string into a fixed-length binary fingerprint that encodes presence/absence of circular substructures. Internally the function builds an RDKit Mol from the provided SMILES using Chem.MolFromSmiles and then computes a Morgan fingerprint as an RDKit bit vector via AllChem.GetMorganFingerprintAsBitVect.` |
| `useful_rdkit_utils_useful_rdkit_utils_smi2numpy_fp` | `useful_rdkit_utils.useful_rdkit_utils.smi2numpy_fp` | `useful_rdkit_utils/useful_rdkit_utils.py` | `smi: str, radius: int = 2, nBits: int = 2048` | `Convert a SMILES string to an RDKit Morgan fingerprint and (internally) populate a numpy array of fingerprint bits.` |
| `useful_rdkit_utils_useful_rdkit_utils_taylor_butina_clustering` | `useful_rdkit_utils.useful_rdkit_utils.taylor_butina_clustering` | `useful_rdkit_utils/useful_rdkit_utils.py` | `fp_list: list, cutoff: float = 0.35` | `Cluster a set of RDKit fingerprints using the Taylor-Butina algorithm (RDKit's Butina.ClusterData) driven by pairwise Tanimoto similarities computed with rdkit.DataStructs.BulkTanimotoSimilarity. This function is provided as part of the useful_rdkit_utils collection of RDKit helper utilities and is used to group molecular fingerprints into discrete clusters based on chemical similarity, useful in tasks such as dataset deduplication, scaffold analysis, or representative selection for cheminformatics workflows.` |

## ‚öñÔ∏è License

Original Code License: MIT

Wrapper Code & Documentation: Apache-2.0

*This file was automatically generated on February 26, 2026.*
