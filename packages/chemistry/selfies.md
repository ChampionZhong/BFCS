# selfies

[üîô Back to Main Repo](../../../README.md) | [üîó Original Repo](https://github.com/aspuru-guzik-group/selfies)

![Tool Count](https://img.shields.io/badge/Agent_Tools-13-blue?style=flat-square)
![Category](https://img.shields.io/badge/Category-Chemistry-green?style=flat-square)
![Status](https://img.shields.io/badge/Import_Test-Passed-success?style=flat-square)

## üìñ Overview

`selfies` provides the SELFIES molecular string representation and tools to encode/decode molecules (e.g., from SMILES) into a 100% robust, always-valid format designed for machine-learning and generative modeling of chemical structures.

> **Note**: This documentation lists the **agent-ready wrapper functions** generated for this package. These functions have been strictly typed, docstring-enhanced, and tested for import stability within a standardized Apptainer environment.

## üõ†Ô∏è Available Agent Tools

Below is the list of **13** functions optimized for LLM tool-use.

| **Tool Name (Wrapper)**   | **Source**          | **File Path**     | **Arguments (Type)**        | **Description**                |
| ------------------------- | ------------------- | ----------------- | --------------------------- | ------------------------------ |
| `selfies_bond_constraints_get_preset_constraints` | `selfies.bond_constraints.get_preset_constraints` | `selfies/bond_constraints.py` | `name: str` | `Returns the preset semantic constraints with the given name. This function is part of the SELFIES library for molecular string representations and is used to obtain a predefined mapping of atom tokens to their allowed bonding capacities (integer maximum bonds). These preset constraints capture common chemical semantics used by SELFIES to enforce or relax bonding rules during encoding, decoding, and generation of molecular graphs for machine learning and cheminformatics workflows. Calling this function lets downstream code (for example, selfies.set_semantic_constraints, encoder, decoder, or any generator that constructs SELFIES strings) apply a consistent, read-only policy for how many bonds each atom type may form. The returned mapping is a shallow copy of an internal preset and can be safely inspected or modified by callers without mutating the global presets stored in the library.` |
| `selfies_compatibility_modernize_symbol` | `selfies.compatibility.modernize_symbol` | `selfies/compatibility.py` | `symbol: str` | `Converts a SELFIES symbol from a pre-v2 representation to its latest equivalent. This function is part of the compatibility utilities in the selfies package and is used when ingesting or transforming SELFIES strings produced by older versions of the library. It attempts to map legacy symbols to their modern equivalents so that downstream SELFIES processing (encoding, decoding, alphabet construction, model input preparation) operates on the current symbol set. The function first consults an internal mapping table of explicit symbol updates. If no direct mapping exists, it applies a second heuristic transform for legacy "expl" symbols (symbols that end with the substring "expl]"), handling an optional bond prefix character and normalizing the atom symbol via the package's SMILES/atom helpers when possible. If no update applies, the original symbol is returned unchanged.` |
| `selfies_decoder_decoder` | `selfies.decoder.decoder` | `selfies/decoder.py` | `selfies: str, compatible: bool = False, attribute: bool = False` | `selfies.decoder.decoder: Translate a SELFIES string into its corresponding SMILES string. Translates a SELFIES molecular representation into a SMILES string deterministically under the library's current semantic constraints (the constraints configured via selfies.set_semantic_constraints). This function is used throughout the SELFIES package and in downstream machine-learning workflows (for example, generative models and random-molecule generation) to convert the robust SELFIES token sequence back into a conventional SMILES string that can be consumed by cheminformatics tools. The output SMILES is guaranteed by the decoder implementation to be syntactically valid and to represent a molecule that obeys the active semantic constraints. The decoder processes dot-separated fragments (SELFIES segments separated by ".") and assembles rings and branches according to those constraints. The implementation constructs an internal MolecularGraph, forms rings bilocally, and then serializes the graph to SMILES; when attribution is requested the function also tracks which input SELFIES tokens contributed to each output SMILES token.` |
| `selfies_encoder_encoder` | `selfies.encoder.encoder` | `selfies/encoder.py` | `smiles: str, strict: bool = True, attribute: bool = False` | `selfies.encoder.encoder translates a SMILES string into its corresponding SELFIES string. This function is the encoder entry point in the selfies package and is used in the chemical string-processing workflow described in the README: it produces a deterministic, machine-learning-friendly SELFIES representation (robust molecular string representation) from a SMILES input, preserving the input atom order so randomized SMILES yield randomized SELFIES.` |
| `selfies_utils_encoding_utils_batch_flat_hot_to_selfies` | `selfies.utils.encoding_utils.batch_flat_hot_to_selfies` | `selfies/utils/encoding_utils.py` | `one_hot_batch: List[List[int]], vocab_itos: Dict[int, str]` | `selfies.utils.encoding_utils.batch_flat_hot_to_selfies converts a batch of flattened one-hot encodings produced by machine learning models into their corresponding SELFIES strings.` |
| `selfies_utils_encoding_utils_batch_selfies_to_flat_hot` | `selfies.utils.encoding_utils.batch_selfies_to_flat_hot` | `selfies/utils/encoding_utils.py` | `selfies_batch: List[str], vocab_stoi: Dict[str, int], pad_to_len: int = -1` | `Converts a batch of SELFIES strings into flattened one-hot encodings. This function is a convenience wrapper used in the SELFIES project to prepare batches of SELFIES strings as fixed-length flat feature vectors for machine learning workflows (for example, input to generative models, VAEs, or classifiers that expect 1D vectors). For each SELFIES string in selfies_batch, this function calls selfies.selfies_to_encoding(selfies, vocab_stoi, pad_to_len, enc_type="one_hot") to obtain a sequence of one-hot vectors and then flattens that sequence into a single list of integers (0/1). The mapping from SELFIES symbols to one-hot positions is determined by vocab_stoi. The pad_to_len argument is forwarded to selfies_to_encoding and controls the padding behavior used when converting each SELFIES string to a fixed-length sequence.` |
| `selfies_utils_encoding_utils_selfies_to_encoding` | `selfies.utils.encoding_utils.selfies_to_encoding` | `selfies/utils/encoding_utils.py` | `selfies: str, vocab_stoi: Dict[str, int], pad_to_len: int = -1, enc_type: str = "both"` | `selfies.utils.encoding_utils.selfies_to_encoding converts a SELFIES string into an integer label encoding and/or a one-hot encoding suitable for machine learning workflows that operate on sequence representations of molecules. This function is used in the SELFIES library to transform the SELFIES token sequence (a robust molecular string representation described in the README) into numeric encodings for use as model inputs, dataset storage, batching, and downstream tasks such as training generative or predictive models. The function uses the helper functions len_selfies and split_selfies to determine symbol length and to tokenize the SELFIES string.` |
| `selfies_utils_matching_utils_find_perfect_matching` | `selfies.utils.matching_utils.find_perfect_matching` | `selfies/utils/matching_utils.py` | `graph: List[List[int]]` | `Finds a perfect matching for an undirected graph (without self-loops) and returns a node-to-partner mapping or None if no perfect matching exists. This utility is part of the selfies.utils.matching_utils module and is intended for use inside the SELFIES codebase where algorithms operate on graph representations of molecules (for example, molecular connectivity graphs used when manipulating rings, branches, or during translation between SMILES and SELFIES). The function accepts an adjacency-list representation of an undirected graph and attempts to pair every vertex with exactly one neighbor so that each vertex appears in exactly one matched pair. The implementation first constructs a maximal greedy matching for efficiency and then repeatedly searches for augmenting paths and flips them until either a perfect matching covering all vertices is found or no augmenting path exists (in which case the function reports failure). The input graph must not contain self-loops; edges are expected to be represented by integer indices in the adjacency lists. The returned matching is a compact representation suitable for downstream graph algorithms in SELFIES that require disjoint pairings of nodes.` |
| `selfies_utils_selfies_utils_len_selfies` | `selfies.utils.selfies_utils.len_selfies` | `selfies/utils/selfies_utils.py` | `selfies: str` | `Returns the number of symbols in a given SELFIES string. In the SELFIES molecular-string domain used throughout this repository (see README), each atomic or structural token is represented as a bracketed symbol such as "[C]" or "[=C]", and the period character "." is used as an explicit symbol to separate disconnected fragments. This function therefore computes the symbol length that is commonly required when constructing alphabets, computing padding lengths for encodings, or sizing input layers for machine learning models that operate on SELFIES.` |
| `selfies_utils_selfies_utils_split_selfies` | `selfies.utils.selfies_utils.split_selfies` | `selfies/utils/selfies_utils.py` | `selfies: str` | `selfies.utils.selfies_utils.split_selfies tokenizes a SELFIES string into its individual symbols and yields them in the original order. This function implements the lexical splitting used across the SELFIES library to convert a SELFIES string (the bracketed-symbol molecular string representation described in the README) into discrete tokens suitable for building alphabets, creating integer or one-hot encodings, and feeding generative or discriminative machine learning models.` |
| `selfies_utils_smiles_utils_smiles_to_atom` | `selfies.utils.smiles_utils.smiles_to_atom` | `selfies/utils/smiles_utils.py` | `atom_symbol: str` | `selfies.utils.smiles_utils.smiles_to_atom parses a single SMILES atom token and returns the corresponding selfies.mol_graph.Atom object used by the SELFIES translation pipeline.` |
| `selfies_utils_smiles_utils_smiles_to_mol` | `selfies.utils.smiles_utils.smiles_to_mol` | `selfies/utils/smiles_utils.py` | `smiles: str, attributable: bool` | `Reads a molecular graph representation from a SMILES string and returns a MolecularGraph suitable for downstream SELFIES operations (encoding, decoding, attribution). This function is a deterministic parser that tokenizes the input SMILES, iteratively derives atoms/bonds/structural features by repeatedly calling internal parsing logic, and constructs a selfies.mol_graph.MolecularGraph object that represents the molecular graph implied by the SMILES. In the SELFIES/SMILES workflow described in the project README, this MolecularGraph is the canonical in-memory graph representation used by higher-level functions (for example, the SELFIES encoder/decoder and attribution utilities).` |
| `selfies_utils_smiles_utils_tokenize_smiles` | `selfies.utils.smiles_utils.tokenize_smiles` | `selfies/utils/smiles_utils.py` | `smiles: str` | `Splits a SMILES string into a stream of SMILESToken objects, yielding tokens in the original left-to-right order for use by higher-level SMILES‚ÜíSELFIES translation and SMILES parsing utilities. This generator implements the low-level lexical analysis used throughout the selfies package to convert a SMILES textual representation of a molecule into token objects that record the token text, its span in the original SMILES string, its token type (the SMILESTokenTypes enum), and an optional index of a preceding bond symbol when present. The function is intended for downstream parsers, attribution mapping (see README examples showing how tokens map to output SMILES), and any component that needs precise token spans for error reporting or semantic processing.` |

## ‚öñÔ∏è License

Original Code License: Apache-2.0

Wrapper Code & Documentation: Apache-2.0

*This file was automatically generated on February 26, 2026.*
